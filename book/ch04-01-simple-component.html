<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Simple Extension Component - The PLCnext Runtime</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="theme/first-edition.css">

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="title-page.html">The PLCnext Runtime</a></li><li class="chapter-item expanded affix "><a href="edition-notice.html">Copyright Notice</a></li><li class="chapter-item expanded affix "><a href="acknowledgments.html">Acknowledgments</a></li><li class="chapter-item expanded affix "><a href="ch00-00-introduction.html">Introduction</a></li><li class="chapter-item expanded "><a href="ch01-00-getting-started.html"><strong aria-hidden="true">1.</strong> Getting Started</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="ch01-01-ip-address.html"><strong aria-hidden="true">1.1.</strong> Setting the IP Address</a></li><li class="chapter-item expanded "><a href="ch01-02-shell-session.html"><strong aria-hidden="true">1.2.</strong> Starting a Shell Session</a></li><li class="chapter-item expanded "><a href="ch01-03-hello-world.html"><strong aria-hidden="true">1.3.</strong> Hello, World!</a></li><li class="chapter-item expanded "><a href="ch01-04-installing-a-software-development-kit.html"><strong aria-hidden="true">1.4.</strong> Installing a Software Development Kit</a></li><li class="chapter-item expanded "><a href="ch01-05-hello-again-world.html"><strong aria-hidden="true">1.5.</strong> Hello Again, World!</a></li></ol></li><li class="chapter-item expanded "><a href="ch02-00-operating-system.html"><strong aria-hidden="true">2.</strong> Operating System</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="ch02-01-security.html"><strong aria-hidden="true">2.1.</strong> Security</a></li><li class="chapter-item expanded "><a href="ch02-02-users-and-privileges.html"><strong aria-hidden="true">2.2.</strong> Users and Privileges</a></li><li class="chapter-item expanded "><a href="ch02-03-setting-the-time.html"><strong aria-hidden="true">2.3.</strong> Setting the Time</a></li><li class="chapter-item expanded "><a href="ch02-04-firmware.html"><strong aria-hidden="true">2.4.</strong> Firmware</a></li><li class="chapter-item expanded "><a href="ch02-05-disk-partitions.html"><strong aria-hidden="true">2.5.</strong> Disk Partitions</a></li><li class="chapter-item expanded "><a href="ch02-06-file-system.html"><strong aria-hidden="true">2.6.</strong> File System</a></li><li class="chapter-item expanded "><a href="ch02-07-installing-software.html"><strong aria-hidden="true">2.7.</strong> Installing Software</a></li></ol></li><li class="chapter-item expanded "><a href="ch03-00-plcnext-runtime.html"><strong aria-hidden="true">3.</strong> PLCnext Runtime</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="ch03-01-controlling-the-plcnext-runtime.html"><strong aria-hidden="true">3.1.</strong> Controlling the PLCnext Runtime</a></li><li class="chapter-item expanded "><a href="ch03-02-diagnosing-problems.html"><strong aria-hidden="true">3.2.</strong> Diagnosing Problems</a></li><li class="chapter-item expanded "><a href="ch03-03-plcnext-runtime-components.html"><strong aria-hidden="true">3.3.</strong> PLCnext Runtime Components</a></li><li class="chapter-item expanded "><a href="ch03-04-component-instances.html"><strong aria-hidden="true">3.4.</strong> Component Instances</a></li><li class="chapter-item expanded "><a href="ch03-05-disabling-features.html"><strong aria-hidden="true">3.5.</strong> Disabling Features</a></li><li class="chapter-item expanded "><a href="ch03-06-rsc-services.html"><strong aria-hidden="true">3.6.</strong> RSC Services</a></li></ol></li><li class="chapter-item expanded "><a href="ch04-00-extension-components.html"><strong aria-hidden="true">4.</strong> Extension Components</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="ch04-01-simple-component.html" class="active"><strong aria-hidden="true">4.1.</strong> Simple Extension Component</a></li><li class="chapter-item expanded "><a href="ch04-02-library-singleton.html"><strong aria-hidden="true">4.2.</strong> Component Library Singleton</a></li><li class="chapter-item expanded "><a href="ch04-03-component-methods.html"><strong aria-hidden="true">4.3.</strong> Component Methods</a></li><li class="chapter-item expanded "><a href="ch04-04-using-rsc-services.html"><strong aria-hidden="true">4.4.</strong> Using RSC Services</a></li><li class="chapter-item expanded "><a href="ch04-05-worker-threads.html"><strong aria-hidden="true">4.5.</strong> Worker Threads</a></li><li class="chapter-item expanded "><a href="ch04-06-creating-gds-variables-1.html"><strong aria-hidden="true">4.6.</strong> Creating GDS variables - Part 1</a></li><li class="chapter-item expanded "><a href="ch04-07-plcnext-cli.html"><strong aria-hidden="true">4.7.</strong> PLCnext CLI</a></li><li class="chapter-item expanded "><a href="ch04-08-creating-gds-variables-2.html"><strong aria-hidden="true">4.8.</strong> Creating GDS variables - Part 2</a></li><li class="chapter-item expanded "><a href="ch04-09-connecting-gds-variables.html"><strong aria-hidden="true">4.9.</strong> Connecting GDS Variables</a></li><li class="chapter-item expanded "><a href="ch04-10-interactive-course.html"><strong aria-hidden="true">4.10.</strong> Interactive Course</a></li></ol></li><li class="chapter-item expanded "><a href="ch05-00-real-time-programming.html"><strong aria-hidden="true">5.</strong> Real Time Programming</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="ch05-01-cpp-programs.html"><strong aria-hidden="true">5.1.</strong> C++ Programs</a></li><li class="chapter-item expanded "><a href="ch05-02-real-time-guidelines.html"><strong aria-hidden="true">5.2.</strong> Real-time C++ Programming Guidelines</a></li><li class="chapter-item expanded "><a href="ch05-03-building-and-deploying.html"><strong aria-hidden="true">5.3.</strong> Building and Deploying a Real-time C++ Application</a></li><li class="chapter-item expanded "><a href="ch05-04-iec-programs.html"><strong aria-hidden="true">5.4.</strong> IEC 61131-3 Programs</a></li></ol></li><li class="chapter-item expanded "><a href="ch06-00-configuring-io.html"><strong aria-hidden="true">6.</strong> Configuring I/O</a></li><li class="chapter-item expanded "><a href="ch07-00-other-tools.html"><strong aria-hidden="true">7.</strong> Other Programming Tools</a></li><li class="chapter-item expanded "><a href="ch08-00-extension-processes.html"><strong aria-hidden="true">8.</strong> Extension Processes</a></li><li class="chapter-item expanded "><a href="ch09-00-what-next.html"><strong aria-hidden="true">9.</strong> What Next</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="ch09-01-the-big-picture.html"><strong aria-hidden="true">9.1.</strong> The Big Picture</a></li><li class="chapter-item expanded "><a href="ch09-02-get-involved.html"><strong aria-hidden="true">9.2.</strong> Get Involved!</a></li></ol></li><li class="chapter-item expanded "><a href="appendix-00.html"><strong aria-hidden="true">10.</strong> Appendix</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="appendix-01-programming-resources.html"><strong aria-hidden="true">10.1.</strong> A - Programming Resources</a></li><li class="chapter-item expanded "><a href="appendix-02-list-of-rsc-services.html"><strong aria-hidden="true">10.2.</strong> B - RSC Services</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">The PLCnext Runtime</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h2 id="simple-extension-component"><a class="header" href="#simple-extension-component">Simple Extension Component</a></h2>
<p>The simplest PLCnext component is a C++ class that inherits <a href="https://api.plcnext.help/api_docs_2021-0-LTS/classArp_1_1System_1_1Acf_1_1ComponentBase.html"><code>Arp::System::Acf::ComponentBase</code></a>.</p>
<p>The C++ source files (<code>.hpp</code> and <code>.cpp</code>) for a simple component, called <code>MyComponent</code>, can be downloaded here:</p>
<ul>
<li><a href="samples/ch04-01-simple-component/MyProject/src/MyComponent.hpp">MyComponent.hpp</a></li>
<li><a href="samples/ch04-01-simple-component/MyProject/src/MyComponent.cpp">MyComponent.cpp</a></li>
</ul>
<p>At this point <code>MyComponent</code> is a valid PLCnext Runtime component, but it contains no functionality - this will be added later.</p>
<h3 id="library-singleton"><a class="header" href="#library-singleton">Library Singleton</a></h3>
<p>Named component instances are created by the PLCnext runtime from a singleton that inherits <a href="https://api.plcnext.help/api_docs_2021-0-LTS/classArp_1_1System_1_1Acf_1_1LibraryBase.html"><code>Arp::System::Acf::LibraryBase</code></a>.</p>
<p>The C++ source files (<code>.hpp</code> and <code>.cpp</code>) for a singleton - called <code>MyLibrary</code> - that creates named instances of <code>MyComponent</code> can be downloaded here:</p>
<ul>
<li><a href="samples/ch04-01-simple-component/MyProject/src/MyLibrary.hpp">MyLibrary.hpp</a></li>
<li><a href="samples/ch04-01-simple-component/MyProject/src/MyLibrary.cpp">MyLibrary.cpp</a></li>
</ul>
<p>Note that both <code>MyComponent</code> and <code>MyLibrary</code> are defined in a namespace called <code>MyNamespace</code>.</p>
<h3 id="building-the-library"><a class="header" href="#building-the-library">Building the Library</a></h3>
<p>You can build a shared object library containing both these classes (<code>MyComponent</code> and <code>MyLibrary</code>) using the SDK that you installed earlier.</p>
<p>The following procedure uses the build tools <code>CMake</code> (version 3.19 or above) and <code>Ninja</code>, so make sure these are also installed on the host machine. The PLCnext CLI installs an older version of CMake which does not support the <a href="https://cmake.org/cmake/help/latest/manual/cmake-presets.7.html">cmake-presets</a> feature used in this procedure.</p>
<p>Build the library as follows:</p>
<ul>
<li>
<p>On your host machine, create a project directory. Under this directory, create a sub-directory called <code>src</code>.</p>
</li>
<li>
<p>Copy the four source files to the <code>src</code> directory.</p>
</li>
<li>
<p>In the project root directory, create a <code>CMakeLists.txt</code> file containing the following text:</p>
</li>
</ul>
<pre><code class="language-cmake">﻿cmake_minimum_required(VERSION 3.13)

project(MyProject)

if(NOT CMAKE_BUILD_TYPE)
  set(CMAKE_BUILD_TYPE Release)
endif()

################# create target #######################################################

set (WILDCARD_SOURCE *.cpp)
set (WILDCARD_HEADER *.h *.hpp *.hxx)

file(GLOB_RECURSE Headers CONFIGURE_DEPENDS src/${WILDCARD_HEADER})
file(GLOB_RECURSE Sources CONFIGURE_DEPENDS src/${WILDCARD_SOURCE})
add_library(MyProject SHARED ${Headers} ${Sources})

#######################################################################################

################# project include-paths ###############################################

target_include_directories(MyProject
    PUBLIC
    $&lt;BUILD_INTERFACE:${CMAKE_CURRENT_SOURCE_DIR}/src&gt;)

#######################################################################################

################# include arp cmake module path #######################################

list(INSERT CMAKE_MODULE_PATH 0 &quot;${ARP_TOOLCHAIN_CMAKE_MODULE_PATH}&quot;)

#######################################################################################

################# set link options ####################################################
# WARNING: Without --no-undefined the linker will not check, whether all necessary    #
#          libraries are linked. When a library which is necessary is not linked,     #
#          the firmware will crash and there will be NO indication why it crashed.    #
#######################################################################################

target_link_options(MyProject PRIVATE LINKER:--no-undefined)

#######################################################################################

################# add link targets ####################################################

find_package(ArpDevice REQUIRED)
find_package(ArpProgramming REQUIRED)

target_link_libraries(MyProject PRIVATE ArpDevice ArpProgramming)

#######################################################################################

################# install ############################################################

string(REGEX REPLACE &quot;^.*\\(([0-9]+\.[0-9]+\.[0-9]+\.[0-9]+).*$&quot; &quot;\\1&quot; _ARP_SHORT_DEVICE_VERSION ${ARP_DEVICE_VERSION})
install(TARGETS MyProject
    LIBRARY DESTINATION ${ARP_DEVICE}_${_ARP_SHORT_DEVICE_VERSION}/$&lt;CONFIG&gt;/lib
    ARCHIVE DESTINATION ${ARP_DEVICE}_${_ARP_SHORT_DEVICE_VERSION}/$&lt;CONFIG&gt;/lib
    RUNTIME DESTINATION ${ARP_DEVICE}_${_ARP_SHORT_DEVICE_VERSION}/$&lt;CONFIG&gt;/bin)
unset(_ARP_SHORT_DEVICE_VERSION)

#######################################################################################
</code></pre>
<ul>
<li>Also in the project root directory, create a <code>CMakePresets.json</code> file containing the following text:</li>
</ul>
<pre><code class="language-json">{
    &quot;version&quot;: 3,
    &quot;cmakeMinimumRequired&quot;: {
        &quot;major&quot;: 3,
        &quot;minor&quot;: 19,
        &quot;patch&quot;: 0
    },
    &quot;configurePresets&quot;: [
        {
            &quot;name&quot;: &quot;default&quot;,
            &quot;hidden&quot;: true,
            &quot;displayName&quot;: &quot;Default Config&quot;,
            &quot;description&quot;: &quot;Default build using Ninja generator&quot;,
            &quot;generator&quot;: &quot;Ninja&quot;,
            &quot;toolchainFile&quot;: &quot;$env{PLCNEXT_SDK_ROOT}/toolchain.cmake&quot;,
            &quot;binaryDir&quot;: &quot;${sourceDir}/bin/$env{ARP_DEVICE}_$env{ARP_DEVICE_VERSION}&quot;,
            &quot;installDir&quot;: &quot;${sourceDir}/deploy&quot;,
            &quot;cacheVariables&quot;: {
                &quot;ARP_DEVICE&quot;: &quot;$env{ARP_DEVICE}&quot;,
                &quot;ARP_DEVICE_VERSION&quot;: &quot;$env{ARP_DEVICE_VERSION}&quot;,
                &quot;CMAKE_BUILD_WITH_INSTALL_RPATH&quot;: true
            }
        },
        {
            &quot;name&quot;: &quot;build-windows-AXCF2152-2021.9.0.40&quot;,
            &quot;inherits&quot;: &quot;default&quot;,
            &quot;displayName&quot;: &quot;AXCF2152-2021.9.0&quot;,
            &quot;environment&quot;: {
                &quot;ARP_DEVICE&quot;: &quot;AXCF2152&quot;,
                &quot;ARP_DEVICE_VERSION&quot;: &quot;2021.9.0 (21.9.0.40)&quot;,
                &quot;PLCNEXT_SDK_ROOT&quot;: &quot;C:\\SDK\\AXCF2152\\2021.9&quot;
            },
            &quot;condition&quot;: {
                &quot;type&quot;: &quot;equals&quot;,
                &quot;lhs&quot;: &quot;${hostSystemName}&quot;,
                &quot;rhs&quot;: &quot;Windows&quot;
            },
            &quot;cacheVariables&quot;: {
                &quot;CMAKE_TOOLCHAIN_FILE&quot;: {
                    &quot;value&quot;: &quot;$env{PLCNEXT_SDK_ROOT}/toolchain.cmake&quot;,
                    &quot;type&quot;: &quot;FILEPATH&quot;
                }
            }
        },
        {
            &quot;name&quot;: &quot;build-linux-AXCF2152-2021.9.0.40&quot;,
            &quot;inherits&quot;: &quot;default&quot;,
            &quot;displayName&quot;: &quot;AXCF2152-2021.9.0&quot;,
            &quot;environment&quot;: {
                &quot;ARP_DEVICE&quot;: &quot;AXCF2152&quot;,
                &quot;ARP_DEVICE_VERSION&quot;: &quot;2021.9.0 (21.9.0.40)&quot;,
                &quot;PLCNEXT_SDK_ROOT&quot;: &quot;/opt/pxc/sdk/AXCF2152/2021.9&quot;
            },
            &quot;condition&quot;: {
                &quot;type&quot;: &quot;equals&quot;,
                &quot;lhs&quot;: &quot;${hostSystemName}&quot;,
                &quot;rhs&quot;: &quot;Linux&quot;
            }
        }
    ],
    &quot;buildPresets&quot;: [
        {
            &quot;name&quot;: &quot;build-linux-AXCF2152-2021.9.0.40&quot;,
            &quot;displayName&quot;: &quot;AXCF2152-2021.9.0&quot;,
            &quot;configurePreset&quot;: &quot;build-linux-AXCF2152-2021.9.0.40&quot;
        }
    ],
    &quot;testPresets&quot;: [
        {
            &quot;name&quot;: &quot;default&quot;,
            &quot;configurePreset&quot;: &quot;default&quot;,
            &quot;output&quot;: {
                &quot;outputOnFailure&quot;: true
            },
            &quot;execution&quot;: {
                &quot;noTestsAction&quot;: &quot;error&quot;,
                &quot;stopOnFailure&quot;: true
            }
        }
    ]
}
</code></pre>
<p>You may need to change the ARP targets and SDK paths in this file to suit the setup of your development machine.</p>
<ul>
<li>
<p>From the project root directory, configure, build and deploy the project:</p>
<pre><code class="language-text">$ cmake --preset=build-linux-AXCF2152-2021.9.0.40
</code></pre>
<pre><code class="language-text">$ cmake --build --preset=build-linux-AXCF2152-2021.9.0.40 --target all
</code></pre>
<pre><code class="language-text">$ cmake --build --preset=build-linux-AXCF2152-2021.9.0.40 --target install
</code></pre>
</li>
</ul>
<p>You will see from the output that a shared object library, <code>libMyProject.so</code>, has been created. This contains the component called <code>MyNamespace::MyComponent</code> and the singleton called <code>MyNamespace::MyLibrary</code>.</p>
<ul>
<li>
<p>On the PLC, create a project directory e.g. <code>/opt/plcnext/projects/MyProject</code>, and a <code>lib</code> subdirectory.</p>
</li>
<li>
<p>Copy the shared object library from the host to the target:</p>
<pre><code class="language-text">$ scp deploy/AXCF2152_21.9.0.40/Release/lib/libMyProject.so admin@192.168.1.10:~/projects/MyProject/lib
</code></pre>
</li>
</ul>
<h3 id="instantiating-the-component"><a class="header" href="#instantiating-the-component">Instantiating the Component</a></h3>
<p>Now that the shared object library containing the extension component is on the target, the PLCnext runtime must be instructed to create an instance of <code>MyComponent</code>.</p>
<ul>
<li>On the host, in the project root directory, create a file named <code>MyProject.acf.config</code>, containing the following text:</li>
</ul>
<pre><code class="language-xml">﻿&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;AcfConfigurationDocument
  xmlns=&quot;http://www.phoenixcontact.com/schema/acfconfig&quot;
  xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
  xsi:schemaLocation=&quot;http://www.phoenixcontact.com/schema/acfconfig.xsd&quot;
  schemaVersion=&quot;1.0&quot; &gt;

  &lt;Processes&gt;
    &lt;Process name=&quot;MyProcess&quot; settingsPath=&quot;$ARP_ACF_SETTINGS_FILE$&quot; /&gt;
  &lt;/Processes&gt;

  &lt;Libraries&gt;
    &lt;Library name=&quot;MyProject&quot; binaryPath=&quot;$ARP_PROJECTS_DIR$/MyProject/lib/libMyProject.so&quot; /&gt;
  &lt;/Libraries&gt;

  &lt;Components&gt;
    &lt;Component name=&quot;MyComponentInstance&quot; type=&quot;MyNamespace::MyComponent&quot; library=&quot;MyProject&quot; process=&quot;MyProcess&quot; /&gt;
  &lt;/Components&gt;

&lt;/AcfConfigurationDocument&gt;
</code></pre>
<ul>
<li>
<p>Copy this ACF configuration file from the host to the target:</p>
<pre><code class="language-text">$ scp MyProject.acf.config admin@192.168.1.10:~/projects/Default
</code></pre>
<p>The PLCnext runtime will automatically load this configuration file, since the <code>Default.acf.config</code> file in the same directory includes all files that match the  pattern <code>*.acf.config</code>. The ACF configuration file for <code>MyProject</code> instructs the PLCnext runtime to:</p>
<ul>
<li>Create a new child process called <code>MyProcess</code>.</li>
<li>Load the shared object library and name it <code>MyProject</code>. This name can be considered an alias, or shorthand reference, to the shared object library. This name does not have any relationship to the name of the class in the shared object library that inherited <code>LibraryBase</code>.</li>
<li>Create an instance of <code>MyNamespace::MyComponent</code>, called <code>MyComponentInstance</code>, from the library named <code>MyProject</code>, in the process named <code>MyProcess</code>.</li>
</ul>
<p>The <code>process</code> parameter is optional and, if omitted, the component instance will be created in the main PLCnext Runtime process (called <code>MainProcess</code>).</p>
</li>
<li>
<p>Restart the PLCnext runtime:</p>
<pre><code class="language-text"># sudo /etc/init.d/plcnext restart &amp;&amp; tail -f -n 0 /opt/plcnext/logs/Output.log
(result)
</code></pre>
</li>
</ul>
<p>Among the messages that appear in the <code>Output.log</code> file, you should see the following:</p>
<pre><code class="language-text">INFO  - Process 'MyProcess' started successfully.
</code></pre>
<pre><code class="language-text">INFO  - Library 'MyProject' in process 'MyProcess' loaded.
</code></pre>
<pre><code class="language-text">INFO  - Component 'MyComponentInstance' in process 'MyProcess' created.
</code></pre>
<p>Your first PLCnext runtime extension component instance is now running!</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="ch04-00-extension-components.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="ch04-02-library-singleton.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="ch04-00-extension-components.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="ch04-02-library-singleton.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
